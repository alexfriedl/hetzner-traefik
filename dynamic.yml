http:
  routers:
    scraper:
      rule: "Host(`hetzner.cwwk.cloud`) && !PathPrefix(`/traefik`) && !PathPrefix(`/bewerber`) && !PathPrefix(`/cv`) && !PathPrefix(`/cadvisor`)"
      service: scraper
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
      priority: 1

    bewerber:
      rule: "Host(`hetzner.cwwk.cloud`) && PathPrefix(`/bewerber`)"
      service: bewerber
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
      middlewares:
        - bewerber-strip
      priority: 10

    cv:
      rule: "Host(`hetzner.cwwk.cloud`) && PathPrefix(`/cv`)"
      service: cv
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
      middlewares:
        - cv-strip
      priority: 10

    cadvisor:
      rule: "Host(`hetzner.cwwk.cloud`) && PathPrefix(`/cadvisor`)"
      service: cadvisor
      entryPoints:
        - websecure
      tls:
        certResolver: letsencrypt
      middlewares:
        - cadvisor-strip
      priority: 10

  middlewares:
    bewerber-strip:
      stripPrefix:
        prefixes:
          - "/bewerber"
    cv-strip:
      stripPrefix:
        prefixes:
          - "/cv"
    cadvisor-strip:
      stripPrefix:
        prefixes:
          - "/cadvisor"

  services:
    scraper:
      loadBalancer:
        servers:
          - url: "http://scraper:3000"

    bewerber:
      loadBalancer:
        servers:
          - url: "http://auto-bewerber:3001"

    cv:
      loadBalancer:
        servers:
          - url: "http://cv-service:3002"

    cadvisor:
      loadBalancer:
        servers:
          - url: "http://cadvisor:8080"
